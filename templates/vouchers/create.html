{% extends "base.html" %}
{% block content %}

<h1>Dodaj voucher</h1>

<form method="post">
  {% csrf_token %}

  <div class="mb-3">
    <label>Typ</label>
    {{ form.type }}
  </div>

  <div id="code" class="mb-3">
    <label>Kod</label>
    {{ form.code }}
  </div>

  <div id="mpv_card_code" class="mb-3">
    <label>Karta MPV</label>
    {{ form.mpv_card_code }}
  </div>

  <div id="value_total" class="mb-3">
    <label>Wartość</label>
    {{ form.value_total }}
  </div>

  <div class="mb-3">
    <label>Imię i nazwisko klienta</label>
    {{ form.client_name }}
  </div>

  <div id="service_name" class="mb-3">
    <label>Nazwa usługi</label>
    {{ form.service_name }}
  </div>

  <div id="receipt_number" class="mb-3">
    <label>Nr paragonu</label>
    {{ form.receipt_number }}
  </div>

  <div id="expiry_date" class="mb-3">
    <label>Data ważności</label>
    {{ form.expiry_date }}
  </div>

  <div class="mb-3">
    <label>Notatki</label>
    {{ form.notes }}
  </div>

  <button type="submit" class="btn btn-primary">
    Zapisz
  </button>

</form>

{% endblock %}

{% block scripts %}
<script>
document.addEventListener("DOMContentLoaded", function () {

  const typeSelect = document.getElementById("id_type");

  const codeField = document.getElementById("code");
  const mpvCardField = document.getElementById("mpv_card_code");
  const valueField = document.getElementById("value_total");
  const serviceField = document.getElementById("service_name");
  const receiptField = document.getElementById("receipt_number");
  const expiryField = document.getElementById("expiry_date");

  function toggleFields() {

    const type = typeSelect.value;

    // reset wszystko
    codeField.style.display = "none";
    mpvCardField.style.display = "none";
    valueField.style.display = "none";
    serviceField.style.display = "none";
    receiptField.style.display = "none";
    expiryField.style.display = "none";

    if (type === "MPV") {
      mpvCardField.style.display = "block";
      valueField.style.display = "block";
      receiptField.style.display = "block";
    }

    else if (type === "SPV") {
      codeField.style.display = "block";
      serviceField.style.display = "block";
      receiptField.style.display = "block";
    }

    else if (type === "OLD") {
      codeField.style.display = "block";
      serviceField.style.display = "block";
      expiryField.style.display = "block";
    }
  }

  toggleFields();
  typeSelect.addEventListener("change", toggleFields);
});
</script>

{% endblock %}
