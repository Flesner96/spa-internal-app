{% extends "base.html" %}
{% block title %}Import seansów{% endblock %}

{% block content %}

<h4 class="section-title mb-3">
  Import seansów
</h4>

<!-- =====================
     TEKST → PARSER
===================== -->

<form method="post">
  {% csrf_token %}

  <textarea
    name="raw_text"
    class="form-control mb-3"
    rows="10"
    placeholder="Wklej tekst z Canvy..."
  ></textarea>

  <button
    type="submit"
    name="action"
    value="preview"
    class="btn btn-primary"
  >
    Podgląd
  </button>

</form>

<!-- =====================
     FORMSET (EDYCJA)
===================== -->

{% if formset %}

<hr>

<h5>Podgląd</h5>

{% if meta %}
<div class="card mb-3">
  <div class="card-body">

    <strong>Data:</strong> {{ meta.date }}<br>
    <strong>Lider:</strong> {{ meta.leader }}

  </div>
</div>
{% endif %}

<form method="post">
  {% csrf_token %}

  {{ formset.management_form }}

  {% for form in formset %}
  <div class="card mb-2">
    <div class="card-body">

      <div class="row g-2">

        <div class="col-md-2">
          {{ form.start_time.label_tag }}
          {{ form.start_time }}
        </div>

        <div class="col-md-5">
          {{ form.session_name.label_tag }}
          {{ form.session_name }}
        </div>

        <div class="col-md-5">
          {{ form.sauna_name.label_tag }}
          {{ form.sauna_name }}
        </div>

      </div>

    </div>
  </div>
  {% endfor %}

  <button
    type="submit"
    name="action"
    value="save"
    class="btn btn-success"
  >
    Zapisz
  </button>

</form>

{% endif %}

{% endblock %}
